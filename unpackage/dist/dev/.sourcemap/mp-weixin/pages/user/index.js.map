{"version":3,"file":"index.js","sources":["pages/user/index.vue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvdXNlci9pbmRleC52dWU"],"sourcesContent":["<template>\r\n\t<view class=\"user-content\">\r\n\t\t<view class=\"user-content-top\">\r\n\t\t\t<view class=\"user-avator\">\r\n\t\t\t\t<view class=\"user-img\">\r\n\t\t\t\t\t<image :src=\"avator\"></image>\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- 未登录：立即登录；已登录：昵称 -->\r\n\t\t\t\t<view class=\"user-login\" @click=\"handleLogin\">\r\n\t\t\t\t\t{{isLogin?nickName:'立即登录'}}\r\n\t\t\t\t</view>\r\n\t\t\t\t<!-- <view class=\"user-nickName\">\r\n\t\t\t\t\t昵称\r\n\t\t\t\t</view> -->\r\n\t\t\t\t<button class=\"user-switch\" hover-class=\"user-switch-active\" v-if=\"isLogin\" @click=\"toggleRole\">\r\n\t\t\t\t\t{{isteacher?'教练版':'学员版'}}\r\n\t\t\t\t</button>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"user-amount\" v-if=\"isLogin\">\r\n\t\t\t\t<view class=\"user-amount-txt\">\r\n\t\t\t\t\t余额\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"user-amount-amount\">\r\n\t\t\t\t\t{{amount}}\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\r\n\t\t\t<view class=\"user-join\">\r\n\t\t\t\t<view class=\"user-join-txt\">\r\n\t\t\t\t\t小区运动主理人\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"user-join-btn\" @click=\"joinTeacher\">\r\n\t\t\t\t\t立即加入\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"user-content-bottom\">\r\n\t\t\t<view class=\"user-content-menu\" @click=\"jumpCollected\">\r\n\t\t\t\t<image src=\"/static/icon/collected.png\" class=\"user-menu-icon\"></image>\r\n\t\t\t\t<view class=\"user-menu-title\">\r\n\t\t\t\t\t我的收藏\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"user-content-menu\" @click=\"jumpModify\">\r\n\t\t\t\t<image src=\"/static/icon/modify.png\" class=\"user-menu-icon\"></image>\r\n\t\t\t\t<view class=\"user-menu-title\">\r\n\t\t\t\t\t修改信息\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"user-content-menu\" @click=\"logout\">\r\n\t\t\t\t<image src=\"/static/icon/logout.png\" class=\"user-menu-icon\"></image>\r\n\t\t\t\t<view class=\"user-menu-title\">\r\n\t\t\t\t\t退出登录\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tuseUserStore\r\n\t} from '../../store/user';\r\n\timport {\r\n\t\tuseAuth\r\n\t} from '@/utils/getUserInfo.js'\r\n\timport {\r\n\t\tgetUser\r\n\t} from '/api/login.js'\r\n\timport {\r\n\t\tgetlogout\r\n\t} from '../../api/login';\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tisLogin: false,\r\n\t\t\t\ttimer: null,\r\n\t\t\t\tnickName: useUserStore().userInfo.nickName,\r\n\t\t\t\tavator: useUserStore().userInfo.avatar,\r\n\t\t\t\tamount: '',\r\n\t\t\t\tisteacher: false,\r\n\t\t\t\t// 是否认证\r\n\t\t\t\tiscertified: false\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onReady() {\r\n\t\t\tif (useUserStore().userInfo.token) {\r\n\t\t\t\tthis.isLogin = true\r\n\t\t\t\t// 查询用户信息\r\n\t\t\t\tconsole.log(useUserStore().userInfo.userId)\r\n\t\t\t\tconst data = await getUser(useUserStore().userInfo.user_id)\r\n\t\t\t\tconsole.log(data)\r\n\t\t\t\tconst oldUserInfo = JSON.parse(localStorage.getItem('userInfo') || '{}');\r\n\r\n\t\t\t\tconst newUserInfo = {\r\n\t\t\t\t\t...oldUserInfo, // 保留旧字段\r\n\t\t\t\t\t...data // 覆盖部分字段（只更新传回来的字段）\r\n\t\t\t\t};\r\n\t\t\t\tlocalStorage.setItem('userInfo', JSON.stringify(newUserInfo));\r\n\t\t\t\tuseUserStore().setUserInfo(localStorage.getItem('userInfo'))\r\n\t\t\t\tthis.amount = data.amount\r\n\t\t\t\tthis.isteacher = data.is_teacher\r\n\t\t\t\tthis.iscertified = data.is_certified\r\n\t\t\t\tthis.nickName = data.nickName\r\n\t\t\t\tthis.avator = data.avatar\r\n\t\t\t\tconsole.log('图片')\r\n\t\t\t\tconsole.log(this.avator)\r\n\t\t\t}\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tclearTimeout(this.timer)\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\thandleLogin() {\r\n\t\t\t\t// 登陆前，跳转登陆页面 登陆采用手机号一键登录 先校验仓库有无token\r\n\t\t\t\tconst token = useUserStore().userInfo.token\r\n\t\t\t\tif (!token) {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"跳转中...\",\r\n\t\t\t\t\t\ticon: \"loading\",\r\n\t\t\t\t\t\tmask: true,\r\n\t\t\t\t\t\tduration: 500\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: '/pages/getUserInfo/getUserInfo'\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 500)\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\t\t\tasync logout() {\r\n\t\t\t\tconst res = await getlogout()\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t\tlocalStorage.removeItem('userInfo');\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: '/pages/getUserInfo/getUserInfo'\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tjoinTeacher() {\r\n\t\t\t\tif (!this.iscertified) {\r\n\t\t\t\t\tconsole.log(this.iscertified)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"跳转中...\",\r\n\t\t\t\t\t\ticon: \"loading\",\r\n\t\t\t\t\t\tmask: true,\r\n\t\t\t\t\t\tduration: 500\r\n\t\t\t\t\t})\r\n\t\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\t\turl: \"/pages/certified/certified\"\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}, 500)\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"已认证\",\r\n\t\t\t\t\t\ticon: \"none\",\r\n\t\t\t\t\t\tmask: true,\r\n\t\t\t\t\t\tduration: 500\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\ttoggleRole() {\r\n\t\t\t\tthis.isteacher = !this.isteacher\r\n\t\t\t\tconst pageTeacher = [{\r\n\t\t\t\t\t\tpage: '/pages/teacherIndex/teacherIndex',\r\n\t\t\t\t\t\tname: '首页',\r\n\t\t\t\t\t\ticonpath: '/static/icon/tabBar/home1.png',\r\n\t\t\t\t\t\tselectedIconPath: '/static/icon/tabBar/home.png'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage: '/pages/group/index',\r\n\t\t\t\t\t\tname: '一键开团',\r\n\t\t\t\t\t\ticonpath: '/static/icon/tabBar/add1.png',\r\n\t\t\t\t\t\tselectedIconPath: '/static/icon/tabBar/add.png'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage: '/pages/myClass/myClass',\r\n\t\t\t\t\t\tname: '我的拼班',\r\n\t\t\t\t\t\ticonpath: '/static/icon/tabBar/student1.png',\r\n\t\t\t\t\t\tselectedIconPath: '/static/icon/tabBar/student.png'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage: '/pages/user/index',\r\n\t\t\t\t\t\tname: '我的',\r\n\t\t\t\t\t\ticonpath: '/static/icon/tabBar/honor1.png',\r\n\t\t\t\t\t\tselectedIconPath: '/static/icon/tabBar/honor.png'\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t\tconst pageStudent = [{\r\n\t\t\t\t\t\tpage: '/pages/index/index',\r\n\t\t\t\t\t\tname: '首页',\r\n\t\t\t\t\t\ticonpath: '/static/resource/images/home1.png',\r\n\t\t\t\t\t\tselectedIconPath: '/static/resource/images/home2.png'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage: '/pages/group/index',\r\n\t\t\t\t\t\tname: '一键开团',\r\n\t\t\t\t\t\ticonpath: '/static/resource/images/group1.png',\r\n\t\t\t\t\t\tselectedIconPath: '/static/resource/images/group2.png'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage: '/pages/order/index',\r\n\t\t\t\t\t\tname: '我的订单',\r\n\t\t\t\t\t\ticonpath: '/static/resource/images/order1.png',\r\n\t\t\t\t\t\tselectedIconPath: '/static/resource/images/order2.png'\r\n\t\t\t\t\t},\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tpage: '/pages/user/index',\r\n\t\t\t\t\t\tname: '我的',\r\n\t\t\t\t\t\ticonpath: '/static/resource/images/user1.png',\r\n\t\t\t\t\t\tselectedIconPath: '/static/resource/images/user2.png'\r\n\t\t\t\t\t}\r\n\t\t\t\t]\r\n\t\t\t\tif (this.isteacher) {\r\n\t\t\t\t\tpageTeacher.forEach((item, index) => {\r\n\t\t\t\t\t\tuni.setTabBarItem({\r\n\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\tpagePath: item.page,\r\n\t\t\t\t\t\t\ttext: item.name,\r\n\t\t\t\t\t\t\ticonPath: item.iconpath,\r\n\t\t\t\t\t\t\tselectedIconPath: item.selectedIconPath\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tpageStudent.forEach((item, index) => {\r\n\t\t\t\t\t\tuni.setTabBarItem({\r\n\t\t\t\t\t\t\tindex: index,\r\n\t\t\t\t\t\t\tpagePath: item.page,\r\n\t\t\t\t\t\t\ttext: item.name,\r\n\t\t\t\t\t\t\ticonPath: item.iconpath,\r\n\t\t\t\t\t\t\tselectedIconPath: item.selectedIconPath\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tjumpCollected() {\r\n\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\turl: \"/pages/collected/collected\"\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 500)\r\n\t\t\t},\r\n\t\t\tjumpModify() {\r\n\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\turl: \"/pages/modify/modify\"\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 500)\r\n\t\t\t}\r\n\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t@import url(./index.css);\r\n</style>","import MiniProgramPage from 'D:/code/project/Sports-Group-buying/pages/user/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["useUserStore","uni","getUser","getlogout"],"mappings":"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"}