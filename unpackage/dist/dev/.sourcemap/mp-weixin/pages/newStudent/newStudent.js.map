{"version":3,"file":"newStudent.js","sources":["pages/newStudent/newStudent.vue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvbmV3U3R1ZGVudC9uZXdTdHVkZW50LnZ1ZQ"],"sourcesContent":["<template>\r\n\t<view class=\"public-container\">\r\n\t\t<uni-forms ref=\"form\" :modelValue=\"formData\">\r\n\t\t\t<!-- ID -->\r\n\t\t\t<uni-forms-item label=\"学员id\" name=\"stuId\" required=\"true\">\r\n\t\t\t\t<uni-easyinput maxlength=\"10\" v-model=\"formData.stuId\" placeholder=\"请输入学员id\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<!-- 昵称 -->\r\n\t\t\t<uni-forms-item label=\"昵称\" name=\"nickName\">\r\n\t\t\t\t<uni-easyinput maxlength=\"20\" v-model=\"formData.nickName\" placeholder=\"请输入学员昵称\" />\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<!-- 头像 -->\r\n\t\t\t<uni-forms-item label=\"学员头像\" name=\"avatar\">\r\n\t\t\t\t<view class=\"image-upload\">\r\n\t\t\t\t\t<image v-if=\"formData.avatar\" :src=\"formData.avatar\" mode=\"aspectFill\" class=\"preview-image\">\r\n\t\t\t\t\t</image>\r\n\t\t\t\t\t<view v-else class=\"upload-btn\" @click=\"chooseImage\">{{formData.avatar?'更换图片':'上传图片'}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<!-- 支付密码 -->\r\n\t\t\t<uni-forms-item label=\"支付密码\" name=\"password\" required=\"true\">\r\n\t\t\t\t<uni-easyinput v-model=\"formData.password\" maxlength=\"6\" type=\"password\" placeholder=\"请输入学员支付密码\"\r\n\t\t\t\t\t@input=\"handleInputPassword\" />\r\n\t\t\t\t<view v-if=\"isshowError\" class=\"password-error\">\r\n\t\t\t\t\t密码格式错误\r\n\t\t\t\t</view>\r\n\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<!-- 支付密码 -->\r\n\t\t\t<uni-forms-item label=\"余额\" name=\"amount\" required=\"true\">\r\n\t\t\t\t<uni-easyinput v-model=\"formData.amount\" placeholder=\"请输入学员余额\" @input=\"handleInputPassword\" />\r\n\t\t\t\t<view v-if=\"isshowError\" class=\"password-error\">\r\n\t\t\t\t\t请输入正确格式\r\n\t\t\t\t</view>\r\n\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<!-- 个人介绍 -->\r\n\t\t\t<uni-forms-item label=\"学员介绍\" name=\"personDesc\">\r\n\t\t\t\t<uni-easyinput type=\"textarea\" v-model=\"formData.personDesc\" placeholder=\"请输入学员介绍\" />\r\n\r\n\t\t\t</uni-forms-item>\r\n\t\t\t<!-- 提交按钮 -->\r\n\t\t\t<view class=\"submit-btn\">\r\n\t\t\t\t<button type=\"primary\" @click=\"submitForm\">提交</button>\r\n\t\t\t</view>\r\n\t\t</uni-forms>\r\n\r\n\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tMODEENUM\r\n\t} from '../../utils/modeEnum'\r\n\timport {\r\n\t\tadminGetStudentDetail\r\n\t} from '../../api/admin'\r\n\timport {\r\n\t\taddStudent\r\n\t} from '../../api/student'\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttempAvatarPath: '', //存放头像临时路径\r\n\t\t\t\tformData: {\r\n\t\t\t\t\tstuId: '',\r\n\t\t\t\t\tnickName: '',\r\n\t\t\t\t\tpersonDesc: '',\r\n\t\t\t\t\tpassword: '',\r\n\t\t\t\t\tconfirmPassword: '',\r\n\t\t\t\t\tavatar: '',\r\n\t\t\t\t\tamount: '',\r\n\t\t\t\t\tisshowError: false,\r\n\t\t\t\t\tisconfirm: false,\r\n\t\t\t\t\tisdisabled: false,\r\n\t\t\t\t\tisshowDetail: false\r\n\t\t\t\t},\r\n\t\t\t\trules: {\r\n\t\t\t\t\tnickName: {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\t\t'required': false,\r\n\t\t\t\t\t\t\t\terrorMessage: '请输入昵称'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tmaxLength: 10,\r\n\t\t\t\t\t\t\t\terrorMessage: '昵称最多不超过10字符',\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t],\r\n\t\t\t\t\t},\r\n\t\t\t\t\tpersonDesc: {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\trequired: false,\r\n\t\t\t\t\t\t\terrorMessage: '请输入个人介绍'\r\n\t\t\t\t\t\t}]\r\n\t\t\t\t\t},\r\n\t\t\t\t\tpassword: {\r\n\t\t\t\t\t\trules: [{\r\n\t\t\t\t\t\t\t\trequired: false,\r\n\t\t\t\t\t\t\t\terrorMessage: '请输入支付密码'\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\tmaxLength: 6,\r\n\t\t\t\t\t\t\t\terrorMessage: '密码最多不超过6字符',\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t]\r\n\t\t\t\t\t},\r\n\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t}\r\n\t\t},\r\n\t\tasync onLoad(options) {\r\n\t\t\tconsole.log(options)\r\n\t\t\tconsole.log('mode', options.mode)\r\n\t\t\tif (MODEENUM.MODIFY === options.mode || MODEENUM.MODIFY === options.mode) {\r\n\t\t\t\tconst res = await adminGetStudentDetail({\r\n\t\t\t\t\tuser_id: options.user_id,\r\n\t\t\t\t})\r\n\t\t\t\tconsole.log(res)\r\n\t\t\t\tthis.formData.stuId = options.user_id\r\n\t\t\t\tthis.formData.nickName = res.nickName\r\n\t\t\t\tthis.formData.personDesc = res.description || ''\r\n\t\t\t\t// this.formData.password = option.user_id\r\n\t\t\t\tthis.formData.amount = res.amount\r\n\t\t\t\t// this.formData.avatar = res.avatar\r\n\t\t\t}\r\n\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\t// 选择图片\r\n\t\t\tchooseImage() {\r\n\t\t\t\tuni.chooseImage({\r\n\t\t\t\t\tcount: 1, //允许选择1张照片\r\n\t\t\t\t\tsizeType: ['compressed'], //压缩图片\r\n\t\t\t\t\tsourceType: ['album', 'camera'], //可从相册或相机选择\r\n\t\t\t\t\tsuccess: (res) => {\r\n\t\t\t\t\t\tconst tempPath = res.tempFilePaths[0];\r\n\t\t\t\t\t\tthis.tempAvatarPath = tempPath;\r\n\t\t\t\t\t\t// 上传到服务器\r\n\t\t\t\t\t\tuni.uploadFile({\r\n\t\t\t\t\t\t\turl: 'http://localhost:3000/api/upload', // 改成你后台实际上传接口\r\n\t\t\t\t\t\t\tfilePath: tempPath,\r\n\t\t\t\t\t\t\tname: 'avatar', // 后端接收的字段名\r\n\t\t\t\t\t\t\tsuccess: (uploadRes) => {\r\n\t\t\t\t\t\t\t\tconst responseData = JSON.parse(uploadRes.data);\r\n\t\t\t\t\t\t\t\tif (responseData.status === 200) {\r\n\t\t\t\t\t\t\t\t\tthis.formData.avatar =\r\n\t\t\t\t\t\t\t\t\t\t`http://localhost:3000${responseData.url}`;\r\n\t\t\t\t\t\t\t\t\tconsole.log('真实路径')\r\n\t\t\t\t\t\t\t\t\tconsole.log(this.formData.avatar)\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '上传成功',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\t\ttitle: '上传失败',\r\n\t\t\t\t\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\tfail: () => {\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '上传失败',\r\n\t\t\t\t\t\t\t\t\ticon: 'error'\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t// 密码校验\r\n\t\t\tisvalidator(password) {\r\n\t\t\t\tconst regex = /^\\d{6}$/;\r\n\t\t\t\tif (!regex.test(password)) {\r\n\t\t\t\t\tthis.isshowError = true\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.isshowError = false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tisvalidatorConfirmPassword(password) {\r\n\t\t\t\tif (password !== this.formData.password) {\r\n\t\t\t\t\tthis.isconfirm = true\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.isconfirm = false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 输入\r\n\t\t\thandleInputPassword(e) {\r\n\t\t\t\tthis.isvalidator(e)\r\n\t\t\t},\r\n\t\t\thandleInput(e) {\r\n\t\t\t\tthis.isvalidatorConfirmPassword(e)\r\n\t\t\t},\r\n\t\t\t// 提交表单\r\n\t\t\tsubmitForm() {\r\n\t\t\t\tthis.$refs.form.validate().then(res => {\r\n\t\t\t\t\tconsole.log('表单数据', this.formData)\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '提交成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t})\r\n\t\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\t\turl: 'pages/myClass/myClass'\r\n\t\t\t\t\t})\r\n\t\t\t\t}).catch(err => {\r\n\t\t\t\t\tconsole.log('表单错误', err)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tasync submitForm() {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tawait this.$refs.form.validate(); // 等待验证通过\r\n\r\n\t\t\t\t\tconst res = await addStudent({\r\n\t\t\t\t\t\tuser_id: this.user_id,\r\n\t\t\t\t\t\tuser_name: this.formData.userName,\r\n\t\t\t\t\t\tnickName: this.formData.nickName,\r\n\t\t\t\t\t\tavatar: this.formData.avatar,\r\n\t\t\t\t\t\tpassword: this.formData.password,\r\n\t\t\t\t\t\tdescription: this.formData.personDesc\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: '提交成功',\r\n\t\t\t\t\t\ticon: 'success'\r\n\t\t\t\t\t});\r\n\t\t\t\t\tconsole.log('结果')\r\n\r\n\t\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\t\tuni.reLaunch({\r\n\t\t\t\t\t\t\turl: '/pages/adminStudent/adminStudent'\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t}, 500)\r\n\t\t\t\t} catch (err) {\r\n\t\t\t\t\tconsole.log('表单错误', err);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n\t@import url(\"newStudent.css\");\r\n</style>","import MiniProgramPage from 'D:/code/project/Sports-Group-buying/pages/newStudent/newStudent.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","MODEENUM","adminGetStudentDetail","addStudent"],"mappings":"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"}