{"version":3,"file":"getUserInfo.js","sources":["pages/getUserInfo/getUserInfo.vue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvZ2V0VXNlckluZm8vZ2V0VXNlckluZm8udnVl"],"sourcesContent":["<template>\r\n\t<view class=\"login-content\">\r\n\t\t<image src=\"/static/logo.png\" class=\"login-background-image\"></image>\r\n\t\t<view class=\"login-phoneNumber-input\">\r\n\t\t\t<uni-easyinput type=\"number\" value=\"phone\" @input=\"getPhoneNumber\" @clear=\"clear\" style=\"font-size: 16rpx;\"\r\n\t\t\t\tmaxlength=\"11\" class=\"login-phoneNumber-input\">\r\n\t\t\t\t<template #left>\r\n\t\t\t\t\t<view>+86</view>\r\n\t\t\t\t</template>\r\n\t\t\t</uni-easyinput>\r\n\t\t</view>\r\n\t\t<view class=\"login-code-input\">\r\n\t\t\t<uni-easyinput type=\"number\" value=\"loginCode\" @input=\"codeInput\" maxlength=\"6\" class=\"login-code-input\">\r\n\t\t\t\t<template #left>\r\n\t\t\t\t\t<view>验证码</view>\r\n\t\t\t\t</template>\r\n\t\t\t\t<template #right>\r\n\t\t\t\t\t<view class=\"login-code-second\" @click=\"getCode\">\r\n\t\t\t\t\t\t{{isgetCode?`${second}s`:getCodeTxt}}\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</template>\r\n\t\t\t</uni-easyinput>\r\n\t\t</view>\r\n\t\t<view class=\"login-btn\" @click=\"login\">\r\n\t\t\t登录\r\n\t\t</view>\r\n\t\t<view>\r\n\t\t\t没有账号会自动注册\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\tgetLoginCode,\r\n\t\tgetLogin\r\n\t} from '../../api/login'\r\n\timport {\r\n\t\tuseUserStore\r\n\t} from '../../store/user'\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttotalSecond: 5,\r\n\t\t\t\tsecond: 5,\r\n\t\t\t\tisgetCode: false,\r\n\t\t\t\tgetCodeTxt: '获取验证码',\r\n\t\t\t\tphone: '',\r\n\t\t\t\tloginCode: '',\r\n\t\t\t\turl: '',\r\n\t\t\t\ttimer: null\r\n\t\t\t}\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tconsole.log(options)\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tclearTimeout(this.timer)\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetPhoneNumber(e) {\r\n\t\t\t\tthis.phone = e\r\n\t\t\t},\r\n\t\t\tcodeInput(e) {\r\n\t\t\t\tthis.loginCode = e\r\n\t\t\t},\r\n\t\t\tclear() {\r\n\t\t\t\tthis.phone = ''\r\n\t\t\t},\r\n\t\t\tvalidatePhoneNum(phoneNum) {\r\n\t\t\t\tconst phoneReg = /^1[3-9]\\d{9}$/\r\n\t\t\t\tif (phoneReg.test(phoneNum)) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"请输入正确的手机号\",\r\n\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tvalidateCode(code) {\r\n\t\t\t\tconst codeReg = /^\\d{6}$/\r\n\t\t\t\tif (codeReg.test(code)) {\r\n\t\t\t\t\treturn true\r\n\t\t\t\t} else {\r\n\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\ttitle: \"请输入正确的验证码\",\r\n\t\t\t\t\t\ticon: \"none\"\r\n\t\t\t\t\t})\r\n\t\t\t\t\treturn false\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\t// 倒计时\r\n\t\t\tasync getCode() {\r\n\t\t\t\tif (!this.validatePhoneNum(this.phone)) {\r\n\t\t\t\t\t// 没通过校验return\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t// 调用获取验证码的接口\r\n\t\t\t\tconst {\r\n\t\t\t\t\tdata: {\r\n\t\t\t\t\t\tcode\r\n\t\t\t\t\t}\r\n\t\t\t\t} = await getLoginCode()\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: `验证码：${code}`\r\n\t\t\t\t})\r\n\t\t\t\t// 开启倒计时\r\n\t\t\t\tthis.isgetCode = true\r\n\t\t\t\tif (!this.timer && this.second === this.totalSecond) {\r\n\t\t\t\t\tconsole.log(this.isgetCode)\r\n\t\t\t\t\tthis.timer = setInterval(() => {\r\n\t\t\t\t\t\tthis.second--\r\n\t\t\t\t\t\tif (this.second <= 0) {\r\n\t\t\t\t\t\t\tthis.isgetCode = false\r\n\t\t\t\t\t\t\tclearInterval(this.timer)\r\n\t\t\t\t\t\t\tthis.timer = null\r\n\t\t\t\t\t\t\tthis.second = this.totalSecond\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 1000)\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tasync login() {\r\n\t\t\t\t// 格式校验\r\n\t\t\t\tif (!this.validatePhoneNum(this.phone) && !this.validateCode(this.loginCode)) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\t// 登录接口\r\n\t\t\t\tconst {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await getLogin(this.phone, this.loginCode)\r\n\t\t\t\tuseUserStore().setUserInfo(data)\r\n\t\t\t\tuni.showToast({\r\n\t\t\t\t\ttitle: \"登陆成功\",\r\n\t\t\t\t\ticon: \"success\",\r\n\t\t\t\t\tmask: true,\r\n\t\t\t\t\tduration: 500\r\n\t\t\t\t})\r\n\t\t\t\tuni.setStorage({\r\n\t\t\t\t\tkey: 'userInfo',\r\n\t\t\t\t\tdata: JSON.stringify(data)\r\n\t\t\t\t})\r\n\t\t\t\tthis.timer = setTimeout(() => {\r\n\t\t\t\t\tuni.switchTab({\r\n\t\t\t\t\t\turl: \"/pages/user/index\"\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 500)\r\n\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\">\r\n\t@import url(./getUserInfo.css);\r\n</style>","import MiniProgramPage from 'D:/code/project/Sports-Group-buying/pages/getUserInfo/getUserInfo.vue'\nwx.createPage(MiniProgramPage)"],"names":["uni","getLoginCode","getLogin","useUserStore"],"mappings":";;;;;AAwCC,MAAK,YAAU;AAAA,EACd,OAAO;AACN,WAAO;AAAA,MACN,aAAa;AAAA,MACb,QAAQ;AAAA,MACR,WAAW;AAAA,MACX,YAAY;AAAA,MACZ,OAAO;AAAA,MACP,WAAW;AAAA,MACX,KAAK;AAAA,MACL,OAAO;AAAA,IACR;AAAA,EACA;AAAA,EACD,OAAO,SAAS;AACfA,kBAAAA,MAAA,MAAA,OAAA,2CAAY,OAAO;AAAA,EACnB;AAAA,EACD,WAAW;AACV,iBAAa,KAAK,KAAK;AAAA,EACvB;AAAA,EACD,SAAS;AAAA,IACR,eAAe,GAAG;AACjB,WAAK,QAAQ;AAAA,IACb;AAAA,IACD,UAAU,GAAG;AACZ,WAAK,YAAY;AAAA,IACjB;AAAA,IACD,QAAQ;AACP,WAAK,QAAQ;AAAA,IACb;AAAA,IACD,iBAAiB,UAAU;AAC1B,YAAM,WAAW;AACjB,UAAI,SAAS,KAAK,QAAQ,GAAG;AAC5B,eAAO;AAAA,aACD;AACNA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AACD,eAAO;AAAA,MACR;AAAA,IACA;AAAA,IACD,aAAa,MAAM;AAClB,YAAM,UAAU;AAChB,UAAI,QAAQ,KAAK,IAAI,GAAG;AACvB,eAAO;AAAA,aACD;AACNA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,SACN;AACD,eAAO;AAAA,MACR;AAAA,IACA;AAAA;AAAA,IAED,MAAM,UAAU;AACf,UAAI,CAAC,KAAK,iBAAiB,KAAK,KAAK,GAAG;AAEvC;AAAA,MACD;AAEA,YAAM;AAAA,QACL,MAAM;AAAA,UACL;AAAA,QACD;AAAA,MACD,IAAI,MAAMC,UAAAA,aAAa;AACvBD,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO,OAAO,IAAI;AAAA,OAClB;AAED,WAAK,YAAY;AACjB,UAAI,CAAC,KAAK,SAAS,KAAK,WAAW,KAAK,aAAa;AACpDA,sBAAAA,+DAAY,KAAK,SAAS;AAC1B,aAAK,QAAQ,YAAY,MAAM;AAC9B,eAAK;AACL,cAAI,KAAK,UAAU,GAAG;AACrB,iBAAK,YAAY;AACjB,0BAAc,KAAK,KAAK;AACxB,iBAAK,QAAQ;AACb,iBAAK,SAAS,KAAK;AAAA,UACpB;AAAA,QACA,GAAE,GAAI;AAAA,MACR;AAAA,IACA;AAAA,IACD,MAAM,QAAQ;AAEb,UAAI,CAAC,KAAK,iBAAiB,KAAK,KAAK,KAAK,CAAC,KAAK,aAAa,KAAK,SAAS,GAAG;AAC7E;AAAA,MACD;AAEA,YAAM;AAAA,QACL;AAAA,MACD,IAAI,MAAME,UAAAA,SAAS,KAAK,OAAO,KAAK,SAAS;AAC7CC,8BAAc,EAAC,YAAY,IAAI;AAC/BH,oBAAAA,MAAI,UAAU;AAAA,QACb,OAAO;AAAA,QACP,MAAM;AAAA,QACN,MAAM;AAAA,QACN,UAAU;AAAA,OACV;AACDA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK;AAAA,QACL,MAAM,KAAK,UAAU,IAAI;AAAA,OACzB;AACD,WAAK,QAAQ,WAAW,MAAM;AAC7BA,sBAAAA,MAAI,UAAU;AAAA,UACb,KAAK;AAAA,SACL;AAAA,MACD,GAAE,GAAG;AAAA,IAEP;AAAA,EACD;AACD;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACtJD,GAAG,WAAW,eAAe;"}